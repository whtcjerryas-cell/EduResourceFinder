# æ•™è‚²è§†é¢‘æœç´¢ç³»ç»Ÿ V2 - å®Œæ•´ SOP æ–‡æ¡£

## ğŸ“‹ ç›®å½•

1. [ç³»ç»Ÿæ¦‚è¿°](#ç³»ç»Ÿæ¦‚è¿°)
2. [ç³»ç»Ÿæ¶æ„](#ç³»ç»Ÿæ¶æ„)
3. [å®Œæ•´æµç¨‹å›¾](#å®Œæ•´æµç¨‹å›¾)
4. [æ ¸å¿ƒç»„ä»¶è¯¦è§£](#æ ¸å¿ƒç»„ä»¶è¯¦è§£)
5. [LLM æç¤ºè¯å®Œæ•´æ¸…å•](#llm-æç¤ºè¯å®Œæ•´æ¸…å•)
6. [æ•°æ®æ¨¡å‹](#æ•°æ®æ¨¡å‹)
7. [API æ¥å£](#api-æ¥å£)
8. [ä½¿ç”¨æµç¨‹](#ä½¿ç”¨æµç¨‹)
9. [é”™è¯¯å¤„ç†ä¸é™çº§æœºåˆ¶](#é”™è¯¯å¤„ç†ä¸é™çº§æœºåˆ¶)
10. [æ—¥å¿—è¾“å‡ºè§„èŒƒ](#æ—¥å¿—è¾“å‡ºè§„èŒƒ)

---

## ç³»ç»Ÿæ¦‚è¿°

### ç›®æ ‡
åŸºäºå›½å®¶ã€å¹´çº§ã€å­¦æœŸã€å­¦ç§‘æœç´¢é«˜è´¨é‡çš„æ•™è‚²è§†é¢‘èµ„æºï¼Œä½¿ç”¨ AI ç”Ÿæˆæœ¬åœ°è¯­è¨€çš„æœç´¢è¯ï¼Œæä¾› Web ç•Œé¢å’Œå†å²è®°å½•åŠŸèƒ½ã€‚

### æ ¸å¿ƒç‰¹æ€§
- **æ™ºèƒ½æœç´¢è¯ç”Ÿæˆ**ï¼šä½¿ç”¨ AI æ ¹æ®å›½å®¶ã€å¹´çº§ã€å­¦æœŸã€å­¦ç§‘è‡ªåŠ¨ç”Ÿæˆæœ¬åœ°è¯­è¨€çš„æœç´¢è¯
- **Web ç•Œé¢**ï¼šå‹å¥½çš„ç”¨æˆ·ç•Œé¢ï¼Œæ”¯æŒé€‰æ‹©å›½å®¶ã€å¹´çº§ã€å­¦ç§‘ç­‰æ¡ä»¶
- **å†å²è®°å½•**ï¼šè‡ªåŠ¨ä¿å­˜æœç´¢å†å²ï¼Œå¯ä»¥å¿«é€ŸæŸ¥çœ‹ä¹‹å‰çš„æœç´¢ç»“æœ
- **å®Œæ•´æ—¥å¿—**ï¼šæ‰€æœ‰æœç´¢è¿‡ç¨‹éƒ½æœ‰è¯¦ç»†çš„æ—¥å¿—è¾“å‡º
- **è§„åˆ™åŒ¹é…å…œåº•**ï¼šä½¿ç”¨ç¡¬è§„åˆ™ç­›é€‰é«˜è´¨é‡èµ„æºï¼Œç¡®ä¿å³ä½¿ LLM å¤±è´¥ä¹Ÿèƒ½æ‰¾åˆ°ç»“æœ

### æŠ€æœ¯æ ˆ
- **åç«¯**ï¼šPython 3.x + Flask
- **å‰ç«¯**ï¼šHTML + CSS + JavaScript
- **æ•°æ®æ¨¡å‹**ï¼šPydantic
- **LLM API**ï¼šAI Builders API (DeepSeek / Gemini)
- **æœç´¢å¼•æ“**ï¼šTavily Search API
- **å­˜å‚¨**ï¼šJSON æ–‡ä»¶ï¼ˆå†å²è®°å½•ï¼‰

---

## ç³»ç»Ÿæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Web Application                        â”‚
â”‚                    (Flask + HTML/JS)                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        â”‚ HTTP Request
                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    SearchEngineV2                            â”‚
â”‚                  (ä¸»æœç´¢å¼•æ“)                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”
        â”‚               â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚QueryGeneratorâ”‚  â”‚ ResultEvaluatorâ”‚
â”‚(AIæœç´¢è¯ç”Ÿæˆ)â”‚  â”‚ (è§„åˆ™åŒ¹é…è¯„ä¼°)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚               â”‚
        â”‚               â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      AIBuildersClient             â”‚
â”‚  (LLM API + Tavily Search API)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ ¸å¿ƒç»„ä»¶

1. **SearchEngineV2**ï¼šä¸»æœç´¢å¼•æ“ç±»ï¼Œåè°ƒæ•´ä¸ªæœç´¢æµç¨‹
2. **QueryGenerator**ï¼šä½¿ç”¨ AI ç”Ÿæˆæœ¬åœ°è¯­è¨€çš„æœç´¢è¯
3. **ResultEvaluator**ï¼šä½¿ç”¨è§„åˆ™åŒ¹é…ç­›é€‰é«˜è´¨é‡èµ„æº
4. **AIBuildersClient**ï¼šAI Builders API å®¢æˆ·ç«¯ï¼ˆLLM + Tavilyï¼‰
5. **Web Application**ï¼šFlask Web åº”ç”¨ï¼Œæä¾› API å’Œç•Œé¢

---

## å®Œæ•´æµç¨‹å›¾

### ä¸»æµç¨‹å›¾

```mermaid
flowchart TD
    Start([ç”¨æˆ·è®¿é—® Web ç•Œé¢]) --> Input[ç”¨æˆ·è¾“å…¥æœç´¢æ¡ä»¶]
    Input --> InputForm{å¡«å†™è¡¨å•}
    InputForm -->|å›½å®¶/å¹´çº§/å­¦æœŸ/å­¦ç§‘| Submit[æäº¤æœç´¢è¯·æ±‚]
    
    Submit --> API[POST /api/search]
    API --> InitEngine[åˆå§‹åŒ– SearchEngineV2]
    
    InitEngine --> Step1[æ­¥éª¤ 1: ç”Ÿæˆæœç´¢è¯]
    Step1 --> CheckLanguage{ç¡®å®šè¯­è¨€}
    CheckLanguage -->|æ ¹æ®å›½å®¶| MapLanguage[è¯­è¨€æ˜ å°„]
    MapLanguage -->|IDâ†’id, CNâ†’zh, USâ†’en| GenPrompt[æ„å»º AI æç¤ºè¯]
    
    GenPrompt --> CallLLM[è°ƒç”¨ LLM ç”Ÿæˆæœç´¢è¯]
    CallLLM --> LLMSuccess{LLM æˆåŠŸ?}
    LLMSuccess -->|æ˜¯| CleanQuery[æ¸…ç†æœç´¢è¯]
    LLMSuccess -->|å¦| FallbackQuery[ä½¿ç”¨é»˜è®¤æœç´¢è¯]
    
    CleanQuery --> Step2[æ­¥éª¤ 2: æ‰§è¡Œæœç´¢]
    FallbackQuery --> Step2
    
    Step2 --> CallTavily[è°ƒç”¨ Tavily Search API]
    CallTavily --> TavilySuccess{Tavily æˆåŠŸ?}
    TavilySuccess -->|æ˜¯| ParseResults[è§£ææœç´¢ç»“æœ]
    TavilySuccess -->|å¦| Error[è¿”å›é”™è¯¯]
    
    ParseResults --> Step3[æ­¥éª¤ 3: è¯„ä¼°ç»“æœ]
    Step3 --> RuleMatch[è§„åˆ™åŒ¹é…è¯„ä¼°]
    
    RuleMatch --> Rule1{è§„åˆ™ 1: æ’­æ”¾åˆ—è¡¨?}
    Rule1 -->|æ˜¯| AddPlaylist[æ ‡è®°ä¸ºæ’­æ”¾åˆ—è¡¨]
    Rule1 -->|å¦| Rule2{è§„åˆ™ 2: é¢‘é“?}
    
    Rule2 -->|æ˜¯| AddChannel[æ ‡è®°ä¸ºé¢‘é“]
    Rule2 -->|å¦| Rule3{è§„åˆ™ 3: EdTech?}
    
    Rule3 -->|æ˜¯| AddEdTech[æ ‡è®°ä¸º EdTech]
    Rule3 -->|å¦| Rule4{è§„åˆ™ 4: ç³»åˆ—è§†é¢‘?}
    
    Rule4 -->|æ˜¯| AddSeries[æ ‡è®°ä¸ºç³»åˆ—è§†é¢‘]
    Rule4 -->|å¦| Skip[è·³è¿‡]
    
    AddPlaylist --> Step4
    AddChannel --> Step4
    AddEdTech --> Step4
    AddSeries --> Step4
    Skip --> Step4
    
    Step4[æ­¥éª¤ 4: ç»Ÿè®¡ç»“æœ] --> CountStats[ç»Ÿè®¡æ’­æ”¾åˆ—è¡¨/è§†é¢‘æ•°é‡]
    CountStats --> BuildResponse[æ„å»º SearchResponse]
    
    BuildResponse --> SaveHistory[ä¿å­˜åˆ°å†å²è®°å½•]
    SaveHistory --> ReturnJSON[è¿”å› JSON å“åº”]
    
    ReturnJSON --> Display[Web ç•Œé¢å±•ç¤ºç»“æœ]
    Display --> End([ç»“æŸ])
    
    Error --> ReturnJSON
    
    style Start fill:#e1f5ff
    style End fill:#c8e6c9
    style Step1 fill:#fff9c4
    style Step2 fill:#fff9c4
    style Step3 fill:#fff9c4
    style Step4 fill:#fff9c4
    style CallLLM fill:#ffccbc
    style CallTavily fill:#ffccbc
    style RuleMatch fill:#c5cae9
```

### LLM è°ƒç”¨æµç¨‹å›¾

```mermaid
flowchart TD
    Start[éœ€è¦è°ƒç”¨ LLM] --> BuildPrompt[æ„å»º System Prompt + User Prompt]
    BuildPrompt --> SelectModel{é€‰æ‹©æ¨¡å‹}
    SelectModel -->|é»˜è®¤| DeepSeek[DeepSeek æ¨¡å‹]
    SelectModel -->|é™çº§| Gemini[Gemini æ¨¡å‹]
    
    DeepSeek --> CallAPI1[è°ƒç”¨ AI Builders API]
    CallAPI1 --> CheckResponse1{å“åº”æˆåŠŸ?}
    CheckResponse1 -->|æ˜¯| CheckContent1{Content éç©º?}
    CheckResponse1 -->|å¦| Retry1{é‡è¯•æ¬¡æ•° < 2?}
    
    CheckContent1 -->|æ˜¯| ReturnSuccess[è¿”å›å†…å®¹]
    CheckContent1 -->|å¦| TryGemini[é™çº§åˆ° Gemini]
    
    Retry1 -->|æ˜¯| Wait1[ç­‰å¾… 1 ç§’]
    Wait1 --> CallAPI1
    Retry1 -->|å¦| TryGemini
    
    TryGemini --> Gemini
    Gemini --> CallAPI2[è°ƒç”¨ AI Builders API]
    CallAPI2 --> CheckResponse2{å“åº”æˆåŠŸ?}
    CheckResponse2 -->|æ˜¯| CheckContent2{Content éç©º?}
    CheckResponse2 -->|å¦| Retry2{é‡è¯•æ¬¡æ•° < 2?}
    
    CheckContent2 -->|æ˜¯| ReturnSuccess
    CheckContent2 -->|å¦| ReturnError[è¿”å›é”™è¯¯/ä½¿ç”¨é»˜è®¤å€¼]
    
    Retry2 -->|æ˜¯| Wait2[ç­‰å¾… 1 ç§’]
    Wait2 --> CallAPI2
    Retry2 -->|å¦| ReturnError
    
    ReturnSuccess --> End([æˆåŠŸ])
    ReturnError --> End
    
    style Start fill:#e1f5ff
    style End fill:#c8e6c9
    style DeepSeek fill:#ffccbc
    style Gemini fill:#ffccbc
    style ReturnSuccess fill:#c8e6c9
    style ReturnError fill:#ffcdd2
```

### è§„åˆ™åŒ¹é…æµç¨‹å›¾

```mermaid
flowchart TD
    Start[å¼€å§‹è¯„ä¼°] --> Loop[éå†æ¯ä¸ªæœç´¢ç»“æœ]
    Loop --> GetURL[è·å– URL å’Œ Title]
    GetURL --> Rule1{è§„åˆ™ 1: æ’­æ”¾åˆ—è¡¨?}
    
    Rule1 -->|youtube.com/playlist<br/>æˆ– list= å‚æ•°| Match1[æ ‡è®°: è§„åˆ™-æ’­æ”¾åˆ—è¡¨]
    Rule1 -->|å¦| Rule2{è§„åˆ™ 2: é¢‘é“?}
    
    Rule2 -->|youtube.com/c/<br/>youtube.com/channel/<br/>youtube.com/@| CheckEdu{åŒ…å«æ•™è‚²å…³é”®è¯?}
    CheckEdu -->|æ˜¯| Match2[æ ‡è®°: è§„åˆ™-é¢‘é“]
    CheckEdu -->|å¦| Rule3{è§„åˆ™ 3: EdTech?}
    
    Rule3 -->|ruangguru.com<br/>zenius.net<br/>ç­‰| Match3[æ ‡è®°: è§„åˆ™-EdTech]
    Rule3 -->|å¦| Rule4{è§„åˆ™ 4: ç³»åˆ—è§†é¢‘?}
    
    Rule4 -->|youtube.com/watch<br/>+ ç³»åˆ—å…³é”®è¯| Match4[æ ‡è®°: è§„åˆ™-ç³»åˆ—è§†é¢‘]
    Rule4 -->|å¦| Skip[è·³è¿‡æ­¤ç»“æœ]
    
    Match1 --> AddResult[æ·»åŠ åˆ°ç»“æœåˆ—è¡¨]
    Match2 --> AddResult
    Match3 --> AddResult
    Match4 --> AddResult
    
    AddResult --> Next{è¿˜æœ‰ç»“æœ?}
    Skip --> Next
    Next -->|æ˜¯| Loop
    Next -->|å¦| Return[è¿”å›ç­›é€‰åçš„ç»“æœ]
    Return --> End([ç»“æŸ])
    
    style Start fill:#e1f5ff
    style End fill:#c8e6c9
    style Match1 fill:#c8e6c9
    style Match2 fill:#c8e6c9
    style Match3 fill:#c8e6c9
    style Match4 fill:#c8e6c9
    style Skip fill:#ffcdd2
```

---

## æ ¸å¿ƒç»„ä»¶è¯¦è§£

### 1. SearchEngineV2

**èŒè´£**ï¼šä¸»æœç´¢å¼•æ“ç±»ï¼Œåè°ƒæ•´ä¸ªæœç´¢æµç¨‹

**ä¸»è¦æ–¹æ³•**ï¼š
- `search(request: SearchRequest) -> SearchResponse`ï¼šæ‰§è¡Œå®Œæ•´æœç´¢æµç¨‹

**å·¥ä½œæµç¨‹**ï¼š
1. æ¥æ”¶æœç´¢è¯·æ±‚ï¼ˆå›½å®¶/å¹´çº§/å­¦æœŸ/å­¦ç§‘ï¼‰
2. è°ƒç”¨ QueryGenerator ç”Ÿæˆæœç´¢è¯
3. è°ƒç”¨ Tavily API æ‰§è¡Œæœç´¢
4. è°ƒç”¨ ResultEvaluator è¯„ä¼°ç»“æœ
5. ç»Ÿè®¡å¹¶è¿”å›ç»“æœ

### 2. QueryGenerator

**èŒè´£**ï¼šä½¿ç”¨ AI ç”Ÿæˆæœ¬åœ°è¯­è¨€çš„æœç´¢è¯

**ä¸»è¦æ–¹æ³•**ï¼š
- `generate_query(request: SearchRequest) -> str`ï¼šç”Ÿæˆæœç´¢è¯

**å·¥ä½œæµç¨‹**ï¼š
1. æ ¹æ®å›½å®¶ç¡®å®šè¯­è¨€
2. æ„å»º System Prompt å’Œ User Prompt
3. è°ƒç”¨ LLM ç”Ÿæˆæœç´¢è¯
4. æ¸…ç†å’Œè¿”å›æœç´¢è¯
5. å¦‚æœå¤±è´¥ï¼Œé™çº§ä¸ºé»˜è®¤æœç´¢è¯

### 3. ResultEvaluator

**èŒè´£**ï¼šä½¿ç”¨è§„åˆ™åŒ¹é…ç­›é€‰é«˜è´¨é‡èµ„æº

**ä¸»è¦æ–¹æ³•**ï¼š
- `evaluate_results(search_results: List[SearchResult]) -> List[SearchResult]`ï¼šè¯„ä¼°å’Œç­›é€‰ç»“æœ

**è§„åˆ™ä¼˜å…ˆçº§**ï¼š
1. YouTube æ’­æ”¾åˆ—è¡¨ï¼ˆæœ€é«˜ä¼˜å…ˆçº§ï¼‰
2. YouTube é¢‘é“é¡µé¢
3. EdTech ç½‘ç«™
4. ç³»åˆ—è§†é¢‘

### 4. AIBuildersClient

**èŒè´£**ï¼šAI Builders API å®¢æˆ·ç«¯

**ä¸»è¦æ–¹æ³•**ï¼š
- `call_llm(...)`ï¼šè°ƒç”¨ LLM API
- `search(...)`ï¼šè°ƒç”¨ Tavily Search API

**ç‰¹æ€§**ï¼š
- æ”¯æŒæ¨¡å‹é™çº§ï¼ˆDeepSeek â†’ Geminiï¼‰
- è‡ªåŠ¨é‡è¯•æœºåˆ¶
- å®Œæ•´çš„é”™è¯¯å¤„ç†

---

## LLM æç¤ºè¯å®Œæ•´æ¸…å•

### æç¤ºè¯ 1: æœç´¢è¯ç”Ÿæˆ (QueryGenerator)

**ç”¨é€”**ï¼šæ ¹æ®å›½å®¶ã€å¹´çº§ã€å­¦æœŸã€å­¦ç§‘ç”Ÿæˆæœç´¢è¯

**æ¨¡å‹**ï¼šDeepSeekï¼ˆé™çº§ï¼šGeminiï¼‰

**System Prompt**ï¼š

```
ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„æœç´¢è¯ç”Ÿæˆä¸“å®¶ï¼Œä¸“é—¨ä¸ºæ•™è‚²è§†é¢‘èµ„æºç”Ÿæˆé«˜è´¨é‡çš„æœç´¢è¯ã€‚
ä½ çš„ä»»åŠ¡æ˜¯æ ¹æ®å›½å®¶ã€å¹´çº§ã€å­¦æœŸã€å­¦ç§‘ä¿¡æ¯ï¼Œç”Ÿæˆä½¿ç”¨{language}è¯­è¨€çš„æœç´¢è¯ã€‚

é‡è¦åŸåˆ™ï¼š
1. ä½¿ç”¨ç›®æ ‡å›½å®¶çš„å®˜æ–¹è¯­è¨€æˆ–å¸¸ç”¨è¯­è¨€
2. ä½¿ç”¨è¯¥å›½å®¶æ•™è‚²ç³»ç»Ÿä¸­å¸¸ç”¨çš„æœ¯è¯­
3. ä¼˜å…ˆä½¿ç”¨"playlist"ã€"è¯¾ç¨‹"ã€"æ•™å­¦è§†é¢‘"ç­‰å…³é”®è¯
4. æœç´¢è¯åº”è¯¥ç®€æ´ã€å‡†ç¡®ã€æœ‰æ•ˆ
5. åªè¿”å›æœç´¢è¯ï¼Œä¸è¦å…¶ä»–è§£é‡Š
```

**User Prompt**ï¼š

```
è¯·ä¸ºä»¥ä¸‹æ•™è‚²è§†é¢‘æœç´¢ç”Ÿæˆæœç´¢è¯ï¼š

å›½å®¶ï¼š{country}
å¹´çº§ï¼š{grade}
å­¦æœŸï¼š{semester or "ä¸æŒ‡å®š"}
å­¦ç§‘ï¼š{subject}
è¯­è¨€ï¼š{language}

è¯·ç”Ÿæˆä¸€ä¸ªç®€æ´æœ‰æ•ˆçš„æœç´¢è¯ï¼Œä½¿ç”¨{language}è¯­è¨€ï¼Œä¼˜å…ˆåŒ…å«"playlist"æˆ–"è¯¾ç¨‹"ç­‰å…³é”®è¯ã€‚

åªè¿”å›æœç´¢è¯ï¼Œä¸è¦å…¶ä»–æ–‡å­—ã€‚
```

**å‚æ•°è¯´æ˜**ï¼š
- `{language}`ï¼šæ ¹æ®å›½å®¶è‡ªåŠ¨æ˜ å°„ï¼ˆIDâ†’id, CNâ†’zh, USâ†’enï¼‰
- `{country}`ï¼šå›½å®¶ä»£ç ï¼ˆå¦‚ï¼šID, CN, USï¼‰
- `{grade}`ï¼šå¹´çº§ï¼ˆå¦‚ï¼š1, Kelas 1, Grade 1ï¼‰
- `{semester}`ï¼šå­¦æœŸï¼ˆå¦‚ï¼š1, Semester 1ï¼‰æˆ–"ä¸æŒ‡å®š"
- `{subject}`ï¼šå­¦ç§‘ï¼ˆå¦‚ï¼šMatematika, Mathematics, æ•°å­¦ï¼‰

**ç¤ºä¾‹è¾“å…¥**ï¼š
```
å›½å®¶ï¼šID
å¹´çº§ï¼š1
å­¦æœŸï¼š1
å­¦ç§‘ï¼šMatematika
è¯­è¨€ï¼šid
```

**ç¤ºä¾‹è¾“å‡º**ï¼š
```
playlist matematika kelas 1 semester 1
```

**é™çº§ç­–ç•¥**ï¼š
- å¦‚æœ LLM è°ƒç”¨å¤±è´¥ï¼Œä½¿ç”¨é»˜è®¤æ ¼å¼ï¼š`{subject} {grade} playlist {semester?}`

---

## æ•°æ®æ¨¡å‹

### SearchRequest

```python
class SearchRequest(BaseModel):
    """æœç´¢è¯·æ±‚"""
    country: str          # å›½å®¶ä»£ç ï¼ˆå¦‚ï¼šID, CN, USï¼‰
    grade: str            # å¹´çº§ï¼ˆå¦‚ï¼š1, 2, 3 æˆ– Kelas 1, Grade 1ï¼‰
    semester: Optional[str]  # å­¦æœŸï¼ˆå¦‚ï¼š1, 2 æˆ– Semester 1ï¼‰ï¼Œå¯é€‰
    subject: str          # å­¦ç§‘ï¼ˆå¦‚ï¼šMatematika, Mathematics, æ•°å­¦ï¼‰
    language: Optional[str]  # æœç´¢è¯­è¨€ï¼ˆå¦‚ï¼šid, en, zhï¼‰ï¼Œå¯é€‰ï¼Œè‡ªåŠ¨æ£€æµ‹
```

**ç¤ºä¾‹**ï¼š
```json
{
    "country": "ID",
    "grade": "1",
    "semester": "1",
    "subject": "Matematika"
}
```

### SearchResult

```python
class SearchResult(BaseModel):
    """å•ä¸ªæœç´¢ç»“æœ"""
    title: str      # æœç´¢ç»“æœæ ‡é¢˜
    url: str        # ç»“æœURL
    snippet: str    # ç»“æœæ‘˜è¦
    source: str     # æ¥æºï¼ˆè§„åˆ™-æ’­æ”¾åˆ—è¡¨/è§„åˆ™-é¢‘é“/è§„åˆ™-EdTech/è§„åˆ™-ç³»åˆ—è§†é¢‘ï¼‰
```

**ç¤ºä¾‹**ï¼š
```json
{
    "title": "Matematika Kelas 1 SD - Playlist Lengkap",
    "url": "https://www.youtube.com/playlist?list=PLxxx",
    "snippet": "Kumpulan video pembelajaran matematika untuk kelas 1...",
    "source": "è§„åˆ™-æ’­æ”¾åˆ—è¡¨"
}
```

### SearchResponse

```python
class SearchResponse(BaseModel):
    """æœç´¢å“åº”"""
    success: bool              # æ˜¯å¦æˆåŠŸ
    query: str                 # ä½¿ç”¨çš„æœç´¢è¯
    results: List[SearchResult]  # æœç´¢ç»“æœåˆ—è¡¨
    total_count: int           # ç»“æœæ€»æ•°
    playlist_count: int        # æ’­æ”¾åˆ—è¡¨æ•°é‡
    video_count: int           # è§†é¢‘æ•°é‡
    message: str               # æ¶ˆæ¯
    timestamp: str             # æ—¶é—´æˆ³ï¼ˆISO æ ¼å¼ï¼‰
```

**ç¤ºä¾‹**ï¼š
```json
{
    "success": true,
    "query": "playlist matematika kelas 1 semester 1",
    "results": [...],
    "total_count": 10,
    "playlist_count": 5,
    "video_count": 3,
    "message": "æœç´¢æˆåŠŸ",
    "timestamp": "2024-01-01T12:00:00"
}
```

---

## API æ¥å£

### 1. POST /api/search

**åŠŸèƒ½**ï¼šæ‰§è¡Œæœç´¢

**è¯·æ±‚ä½“**ï¼š
```json
{
    "country": "ID",
    "grade": "1",
    "semester": "1",
    "subject": "Matematika"
}
```

**å“åº”**ï¼š
```json
{
    "success": true,
    "query": "playlist matematika kelas 1 semester 1",
    "results": [
        {
            "title": "...",
            "url": "...",
            "snippet": "...",
            "source": "è§„åˆ™-æ’­æ”¾åˆ—è¡¨"
        }
    ],
    "total_count": 10,
    "playlist_count": 5,
    "video_count": 3,
    "message": "æœç´¢æˆåŠŸ",
    "timestamp": "2024-01-01T12:00:00"
}
```

### 2. GET /api/history

**åŠŸèƒ½**ï¼šè·å–æ‰€æœ‰å†å²è®°å½•

**å“åº”**ï¼š
```json
{
    "success": true,
    "history": [
        {
            "timestamp": "2024-01-01T12:00:00",
            "request": {...},
            "response": {...}
        }
    ]
}
```

### 3. GET /api/history/<index>

**åŠŸèƒ½**ï¼šè·å–ç‰¹å®šå†å²è®°å½•

**å“åº”**ï¼š
```json
{
    "success": true,
    "item": {
        "timestamp": "2024-01-01T12:00:00",
        "request": {...},
        "response": {...}
    }
}
```

---

## ä½¿ç”¨æµç¨‹

### Web ç•Œé¢ä½¿ç”¨

1. **å¯åŠ¨åº”ç”¨**
   ```bash
   python3 web_app.py
   ```

2. **è®¿é—®ç•Œé¢**
   - æ‰“å¼€æµè§ˆå™¨è®¿é—® `http://localhost:5000`

3. **æ‰§è¡Œæœç´¢**
   - é€‰æ‹©å›½å®¶ï¼ˆä¸‹æ‹‰èœå•ï¼‰
   - è¾“å…¥å¹´çº§ï¼ˆæ–‡æœ¬è¾“å…¥ï¼‰
   - è¾“å…¥å­¦æœŸï¼ˆå¯é€‰ï¼Œæ–‡æœ¬è¾“å…¥ï¼‰
   - è¾“å…¥å­¦ç§‘ï¼ˆæ–‡æœ¬è¾“å…¥ï¼‰
   - ç‚¹å‡»"å¼€å§‹æœç´¢"æŒ‰é’®

4. **æŸ¥çœ‹ç»“æœ**
   - æœç´¢ç»“æœå®æ—¶æ˜¾ç¤ºåœ¨ä¸‹æ–¹
   - æ˜¾ç¤ºç»Ÿè®¡ä¿¡æ¯ï¼ˆæ€»æ•°/æ’­æ”¾åˆ—è¡¨/è§†é¢‘ï¼‰
   - æ¯ä¸ªç»“æœåŒ…å«æ ‡é¢˜ã€URLã€æ‘˜è¦ã€æ¥æº

5. **æŸ¥çœ‹å†å²**
   - å³ä¾§æ˜¾ç¤ºæœç´¢å†å²
   - ç‚¹å‡»å†å²è®°å½•å¯é‡æ–°åŠ è½½ç»“æœ

### å‘½ä»¤è¡Œä½¿ç”¨

```python
from search_engine_v2 import SearchEngineV2, SearchRequest

# åˆå§‹åŒ–æœç´¢å¼•æ“
engine = SearchEngineV2()

# æ„å»ºæœç´¢è¯·æ±‚
request = SearchRequest(
    country="ID",
    grade="1",
    semester="1",
    subject="Matematika"
)

# æ‰§è¡Œæœç´¢
result = engine.search(request)

# æŸ¥çœ‹ç»“æœ
print(f"æœç´¢è¯: {result.query}")
print(f"æ‰¾åˆ° {result.total_count} ä¸ªç»“æœ")
print(f"æ’­æ”¾åˆ—è¡¨: {result.playlist_count} ä¸ª")
print(f"è§†é¢‘: {result.video_count} ä¸ª")

for r in result.results:
    print(f"- {r.title}: {r.url}")
```

---

## é”™è¯¯å¤„ç†ä¸é™çº§æœºåˆ¶

### LLM è°ƒç”¨é™çº§

1. **ç¬¬ä¸€ä¼˜å…ˆçº§**ï¼šDeepSeek æ¨¡å‹
2. **é™çº§æ–¹æ¡ˆ**ï¼šå¦‚æœ DeepSeek å¤±è´¥ï¼Œè‡ªåŠ¨åˆ‡æ¢åˆ° Gemini
3. **æœ€ç»ˆé™çº§**ï¼šå¦‚æœæ‰€æœ‰ LLM å¤±è´¥ï¼Œä½¿ç”¨é»˜è®¤æœç´¢è¯æ ¼å¼

### æœç´¢ API é™çº§

1. **ä¸»è¦æ–¹æ¡ˆ**ï¼šTavily Search API
2. **é”™è¯¯å¤„ç†**ï¼šå¦‚æœ API è°ƒç”¨å¤±è´¥ï¼Œè¿”å›é”™è¯¯ä¿¡æ¯ï¼Œä¸è¿›è¡Œé™çº§ï¼ˆå› ä¸º Tavily æ˜¯å”¯ä¸€å¯ç”¨çš„æœç´¢ APIï¼‰

### è§„åˆ™åŒ¹é…å…œåº•

- å³ä½¿ LLM ç”Ÿæˆæœç´¢è¯å¤±è´¥ï¼Œè§„åˆ™åŒ¹é…ä»ç„¶å¯ä»¥ç­›é€‰å‡ºé«˜è´¨é‡èµ„æº
- è§„åˆ™åŒ¹é…ä¸ä¾èµ– LLMï¼Œå®Œå…¨åŸºäº URL å’Œæ ‡é¢˜çš„ç¡¬è§„åˆ™

---

## æ—¥å¿—è¾“å‡ºè§„èŒƒ

### æ—¥å¿—æ ¼å¼

æ‰€æœ‰æ—¥å¿—éƒ½éµå¾ªä»¥ä¸‹æ ¼å¼ï¼š

```
[æ­¥éª¤ X] æ­¥éª¤åç§°...
    [ğŸ”/âœ…/âš ï¸/âŒ ç±»å‹] å…·ä½“ä¿¡æ¯...
```

### æ—¥å¿—ç¤ºä¾‹

```
================================================================================
ğŸ” å¼€å§‹æœç´¢
================================================================================
å›½å®¶: ID
å¹´çº§: 1
å­¦æœŸ: 1
å­¦ç§‘: Matematika
================================================================================

[æ­¥éª¤ 1] ç”Ÿæˆæœç´¢è¯...
    [ğŸ¤– AI ç”Ÿæˆ] æ­£åœ¨ä¸º ID/1/Matematika ç”Ÿæˆæœç´¢è¯...
    [âœ… AI ç”Ÿæˆ] æœç´¢è¯: "playlist matematika kelas 1 semester 1"

[æ­¥éª¤ 2] æ‰§è¡Œæœç´¢...
    [ğŸ” æœç´¢] æŸ¥è¯¢: "playlist matematika kelas 1 semester 1"
    [âœ… æœç´¢] æ‰¾åˆ° 20 ä¸ªç»“æœ

[æ­¥éª¤ 3] è¯„ä¼°ç»“æœ...
    [ğŸ“‹ è¯„ä¼°] æ­£åœ¨è¯„ä¼° 20 ä¸ªæœç´¢ç»“æœ...
    [âœ… è¯„ä¼°] æ‰¾åˆ° 5 ä¸ªé«˜è´¨é‡èµ„æº

[æ­¥éª¤ 4] ç»Ÿè®¡ç»“æœ...
    [ğŸ“Š ç»Ÿè®¡] æ’­æ”¾åˆ—è¡¨: 2 ä¸ª
    [ğŸ“Š ç»Ÿè®¡] è§†é¢‘: 2 ä¸ª
    [ğŸ“Š ç»Ÿè®¡] æ€»è®¡: 5 ä¸ª
```

### æ—¥å¿—ç±»å‹è¯´æ˜

- `ğŸ”`ï¼šä¿¡æ¯/è°ƒè¯•
- `âœ…`ï¼šæˆåŠŸ
- `âš ï¸`ï¼šè­¦å‘Š
- `âŒ`ï¼šé”™è¯¯

---

## è§„åˆ™åŒ¹é…è¯¦ç»†è¯´æ˜

### è§„åˆ™ 1: YouTube æ’­æ”¾åˆ—è¡¨

**åŒ¹é…æ¡ä»¶**ï¼š
- URL åŒ…å« `youtube.com/playlist`
- æˆ– URL åŒ…å« `youtube.com/watch` ä¸”åŒ…å« `list=` å‚æ•°

**ä¼˜å…ˆçº§**ï¼šæœ€é«˜ï¼ˆ100% ç¡®å®šï¼‰

**æ ‡è®°**ï¼š`è§„åˆ™-æ’­æ”¾åˆ—è¡¨`

### è§„åˆ™ 2: YouTube é¢‘é“é¡µé¢

**åŒ¹é…æ¡ä»¶**ï¼š
- URL åŒ…å«ä»¥ä¸‹ä»»ä¸€æ¨¡å¼ï¼š
  - `youtube.com/c/`
  - `youtube.com/channel/`
  - `youtube.com/@`
- ä¸”æ ‡é¢˜åŒ…å«æ•™è‚²ç›¸å…³å…³é”®è¯ï¼š
  - `education`, `belajar`, `pembelajaran`, `tutorial`, `è¯¾ç¨‹`, `æ•™å­¦`

**ä¼˜å…ˆçº§**ï¼šé«˜

**æ ‡è®°**ï¼š`è§„åˆ™-é¢‘é“`

### è§„åˆ™ 3: EdTech ç½‘ç«™

**åŒ¹é…æ¡ä»¶**ï¼š
- URL åŒ…å«ä»¥ä¸‹ä»»ä¸€åŸŸåï¼š
  - `ruangguru.com`
  - `zenius.net`
  - `quipper.com`
  - `pahamify.com`
  - `kelaspintar.id`
  - `khanacademy.org`
  - `coursera.org`
  - `edx.org`

**ä¼˜å…ˆçº§**ï¼šé«˜

**æ ‡è®°**ï¼š`è§„åˆ™-EdTech`

### è§„åˆ™ 4: ç³»åˆ—è§†é¢‘

**åŒ¹é…æ¡ä»¶**ï¼š
- URL åŒ…å« `youtube.com/watch`
- ä¸”æ ‡é¢˜åŒ…å«ä»¥ä¸‹ä»»ä¸€å…³é”®è¯ï¼š
  - `part`, `bagian`, `episode`, `seri`, `series`
  - `full`, `lengkap`, `complete`, `playlist`, `kumpulan`
  - `ç¬¬`, `é›†`, `ç³»åˆ—`

**ä¼˜å…ˆçº§**ï¼šä¸­

**æ ‡è®°**ï¼š`è§„åˆ™-ç³»åˆ—è§†é¢‘`

---

## å›½å®¶ä¸è¯­è¨€æ˜ å°„

| å›½å®¶ä»£ç  | å›½å®¶åç§° | è¯­è¨€ä»£ç  | è¯­è¨€åç§° |
|---------|---------|---------|---------|
| ID | å°å°¼ | id | å°å°¼è¯­ |
| CN | ä¸­å›½ | zh | ä¸­æ–‡ |
| US | ç¾å›½ | en | è‹±è¯­ |
| MY | é©¬æ¥è¥¿äºš | ms | é©¬æ¥è¯­ |
| SG | æ–°åŠ å¡ | en | è‹±è¯­ |
| IN | å°åº¦ | en | è‹±è¯­ |

---

## æ–‡ä»¶ç»“æ„

```
.
â”œâ”€â”€ search_engine_v2.py      # æ–°ç‰ˆæœç´¢å¼•æ“æ ¸å¿ƒ
â”‚   â”œâ”€â”€ SearchEngineV2       # ä¸»æœç´¢å¼•æ“ç±»
â”‚   â”œâ”€â”€ QueryGenerator       # AI æœç´¢è¯ç”Ÿæˆå™¨
â”‚   â”œâ”€â”€ ResultEvaluator      # ç»“æœè¯„ä¼°å™¨
â”‚   â””â”€â”€ AIBuildersClient     # API å®¢æˆ·ç«¯
â”‚
â”œâ”€â”€ web_app.py               # Flask Web åº”ç”¨
â”‚   â”œâ”€â”€ /                    # ä¸»é¡µ
â”‚   â”œâ”€â”€ /api/search          # æœç´¢ API
â”‚   â”œâ”€â”€ /api/history         # å†å²è®°å½• API
â”‚   â””â”€â”€ /api/history/<id>    # ç‰¹å®šå†å²è®°å½•
â”‚
â”œâ”€â”€ templates/
â”‚   â””â”€â”€ index.html           # å‰ç«¯ç•Œé¢
â”‚
â”œâ”€â”€ search_history.json       # å†å²è®°å½•å­˜å‚¨ï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼‰
â”‚
â”œâ”€â”€ requirements_web.txt     # ä¾èµ–é¡¹
â”‚
â””â”€â”€ SOP_V2_COMPLETE.md       # æœ¬æ–‡æ¡£
```

---

## ç¯å¢ƒå˜é‡

### å¿…éœ€

- `AI_BUILDER_TOKEN`ï¼šAI Builders API ä»¤ç‰Œ

### è®¾ç½®æ–¹æ³•

```bash
# æ–¹æ³• 1: ç¯å¢ƒå˜é‡
export AI_BUILDER_TOKEN="your_token_here"

# æ–¹æ³• 2: .env æ–‡ä»¶
echo "AI_BUILDER_TOKEN=your_token_here" > .env
```

---

## ä¾èµ–å®‰è£…

```bash
pip install -r requirements_web.txt
```

**ä¾èµ–é¡¹**ï¼š
- `flask>=2.3.0`
- `flask-cors>=4.0.0`
- `requests>=2.31.0`
- `pydantic>=2.0.0`
- `python-dotenv>=1.0.0`

---

## å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…ä¾èµ–

```bash
pip install -r requirements_web.txt
```

### 2. è®¾ç½®ç¯å¢ƒå˜é‡

```bash
export AI_BUILDER_TOKEN="your_token_here"
```

### 3. å¯åŠ¨ Web åº”ç”¨

```bash
python3 web_app.py
```

### 4. è®¿é—®ç•Œé¢

æ‰“å¼€æµè§ˆå™¨è®¿é—® `http://localhost:5000`

---

## æ•…éšœæ’é™¤

### é—®é¢˜ 1: LLM è¿”å›ç©ºå†…å®¹

**åŸå› **ï¼šå¯èƒ½æ˜¯ Gemini çš„å®‰å…¨è®¾ç½®é™åˆ¶

**è§£å†³æ–¹æ¡ˆ**ï¼š
- ç³»ç»Ÿä¼šè‡ªåŠ¨é™çº§åˆ° DeepSeek
- å¦‚æœ DeepSeek ä¹Ÿå¤±è´¥ï¼Œä½¿ç”¨é»˜è®¤æœç´¢è¯æ ¼å¼

### é—®é¢˜ 2: Tavily API è°ƒç”¨å¤±è´¥

**åŸå› **ï¼šAPI å¯†é’¥æ— æ•ˆæˆ–ç½‘ç»œé—®é¢˜

**è§£å†³æ–¹æ¡ˆ**ï¼š
- æ£€æŸ¥ `AI_BUILDER_TOKEN` æ˜¯å¦æ­£ç¡®è®¾ç½®
- æ£€æŸ¥ç½‘ç»œè¿æ¥
- æŸ¥çœ‹æ—¥å¿—ä¸­çš„è¯¦ç»†é”™è¯¯ä¿¡æ¯

### é—®é¢˜ 3: æœç´¢ç»“æœä¸ºç©º

**åŸå› **ï¼šæœç´¢è¯ä¸å‡†ç¡®æˆ–ç¡®å®æ²¡æœ‰ç›¸å…³èµ„æº

**è§£å†³æ–¹æ¡ˆ**ï¼š
- å°è¯•ä¸åŒçš„å¹´çº§æˆ–å­¦æœŸ
- ä½¿ç”¨æ›´é€šç”¨çš„å­¦ç§‘åç§°
- æ£€æŸ¥è§„åˆ™åŒ¹é…æ˜¯å¦è¿‡äºä¸¥æ ¼

---

## æ€§èƒ½ä¼˜åŒ–å»ºè®®

1. **ç¼“å­˜æœç´¢è¯**ï¼šç›¸åŒæ¡ä»¶çš„æœç´¢å¯ä»¥ç¼“å­˜ç”Ÿæˆçš„æœç´¢è¯
2. **æ‰¹é‡æœç´¢**ï¼šæ”¯æŒæ‰¹é‡æœç´¢å¤šä¸ªæ¡ä»¶
3. **å¼‚æ­¥å¤„ç†**ï¼šå¯¹äºå¤§é‡æœç´¢ï¼Œå¯ä»¥ä½¿ç”¨å¼‚æ­¥å¤„ç†
4. **ç»“æœç¼“å­˜**ï¼šç¼“å­˜æœç´¢ç»“æœï¼Œé¿å…é‡å¤æœç´¢

---

## æœªæ¥æ”¹è¿›æ–¹å‘

1. **å¤šè¯­è¨€æ”¯æŒ**ï¼šæ‰©å±•æ›´å¤šå›½å®¶å’Œè¯­è¨€
2. **æœç´¢ç»“æœè¯„åˆ†**ï¼šä½¿ç”¨ LLM å¯¹æœç´¢ç»“æœè¿›è¡Œè¯„åˆ†å’Œæ’åº
3. **æ‰¹é‡æœç´¢**ï¼šæ”¯æŒä¸€æ¬¡æœç´¢å¤šä¸ªæ¡ä»¶
4. **ç»“æœå¯¼å‡º**ï¼šæ”¯æŒå¯¼å‡ºæœç´¢ç»“æœä¸º CSV/JSON
5. **ç”¨æˆ·è‡ªå®šä¹‰è§„åˆ™**ï¼šå…è®¸ç”¨æˆ·è‡ªå®šä¹‰è§„åˆ™åŒ¹é…æ¡ä»¶
6. **æœç´¢ç»“æœé¢„è§ˆ**ï¼šé›†æˆè§†é¢‘é¢„è§ˆåŠŸèƒ½

---

## ç‰ˆæœ¬å†å²

### V2.0 (å½“å‰ç‰ˆæœ¬)
- é‡æ„æœç´¢ç­–ç•¥ï¼šä»çŸ¥è¯†ç‚¹æœç´¢æ”¹ä¸ºå›½å®¶/å¹´çº§/å­¦æœŸæœç´¢
- æ·»åŠ  Web ç•Œé¢
- æ·»åŠ å†å²è®°å½•åŠŸèƒ½
- ä½¿ç”¨ AI ç”Ÿæˆæœ¬åœ°è¯­è¨€æœç´¢è¯
- å®Œæ•´çš„æ—¥å¿—è¾“å‡º

### V1.0 (æ—§ç‰ˆæœ¬)
- åŸºäºçŸ¥è¯†ç‚¹çš„æœç´¢
- å‘½ä»¤è¡Œç•Œé¢
- LLM ç»“æœè¯„ä¼°
- è§„åˆ™åŒ¹é…å…œåº•æœºåˆ¶

---

## è”ç³»ä¸æ”¯æŒ

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·æŸ¥çœ‹ï¼š
- ä»£ç ä»“åº“
- æ–‡æ¡£ç›®å½•
- æ—¥å¿—æ–‡ä»¶

---

**æ–‡æ¡£ç‰ˆæœ¬**ï¼šV2.0  
**æœ€åæ›´æ–°**ï¼š2024-01-01  
**ç»´æŠ¤è€…**ï¼šAI Assistant

