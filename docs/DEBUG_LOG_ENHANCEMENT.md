# Debug æ—¥å¿—å¢žå¼ºåŠŸèƒ½æ€»ç»“

## ðŸ“… æ›´æ–°æ—¥æœŸ
2025-12-29

## ðŸŽ¯ æ›´æ–°å†…å®¹

### 1. åŽç«¯è¯¦ç»†æ—¥å¿—è¾“å‡º âœ…

#### LLM è°ƒç”¨æ—¥å¿— (`search_engine_v2.py`, `result_evaluator.py`)

**è¾“å…¥é˜¶æ®µ**:
- âœ… Endpoint URL
- âœ… Model åç§°ï¼ˆdeepseek/gemini-2.5-proï¼‰
- âœ… Max Tokens å’Œ Temperature å‚æ•°
- âœ… System Prompt é•¿åº¦å’Œå†…å®¹ï¼ˆå‰500å­—ç¬¦é¢„è§ˆ + å®Œæ•´å†…å®¹ï¼‰
- âœ… User Prompt é•¿åº¦å’Œå†…å®¹ï¼ˆå‰500å­—ç¬¦é¢„è§ˆ + å®Œæ•´å†…å®¹ï¼‰
- âœ… å®Œæ•´çš„ Payloadï¼ˆJSONæ ¼å¼ï¼‰

**è¾“å‡ºé˜¶æ®µ**:
- âœ… HTTP çŠ¶æ€ç 
- âœ… å“åº”æ—¶é—´ï¼ˆç§’ï¼‰
- âœ… å“åº”ç±»åž‹å’Œç»“æž„
- âœ… å®Œæ•´çš„ API å“åº”ï¼ˆJSONæ ¼å¼ï¼‰
- âœ… Finish Reason
- âœ… Content é•¿åº¦å’Œå†…å®¹ï¼ˆå‰1000å­—ç¬¦é¢„è§ˆ + å®Œæ•´å†…å®¹ï¼‰
- âœ… Token ä½¿ç”¨æƒ…å†µï¼ˆPrompt Tokens, Completion Tokens, Total Tokensï¼‰
- âœ… Orchestrator Traceï¼ˆå¦‚æžœå­˜åœ¨ï¼Œç”¨äºŽè°ƒè¯•ï¼‰

**é”™è¯¯å¤„ç†**:
- âœ… è¯¦ç»†çš„é”™è¯¯ä¿¡æ¯
- âœ… é”™è¯¯å“åº”å†…å®¹
- âœ… å¼‚å¸¸ç±»åž‹å’Œå †æ ˆè·Ÿè¸ª

#### Tavily æœç´¢ API æ—¥å¿— (`search_engine_v2.py`)

**è¾“å…¥é˜¶æ®µ**:
- âœ… åŽŸå§‹æŸ¥è¯¢è¯
- âœ… Max Results å’Œ Include Domains å‚æ•°
- âœ… Endpoint URL
- âœ… æŸ¥è¯¢å¢žå¼ºè¿‡ç¨‹ï¼ˆsite:è¯­æ³•æ·»åŠ ï¼‰
- âœ… å®Œæ•´çš„ Payloadï¼ˆJSONæ ¼å¼ï¼‰
- âœ… Headersï¼ˆéšè—Authorizationï¼‰

**è¾“å‡ºé˜¶æ®µ**:
- âœ… HTTP çŠ¶æ€ç 
- âœ… å“åº”æ—¶é—´ï¼ˆç§’ï¼‰
- âœ… å®Œæ•´çš„ API å“åº”ï¼ˆJSONæ ¼å¼ï¼‰
- âœ… Queries æ•°é‡
- âœ… Tavily ç»“æžœæ•°é‡
- âœ… æ¯ä¸ªç»“æžœçš„è¯¦ç»†ä¿¡æ¯ï¼š
  - æ ‡é¢˜
  - URL
  - Snippet é•¿åº¦å’Œå†…å®¹ï¼ˆå‰200å­—ç¬¦ï¼‰
  - åŸŸååŒ¹é…æƒ…å†µ

#### ç»“æžœè¯„ä¼°æ—¥å¿— (`result_evaluator.py`)

**è¾“å…¥é˜¶æ®µ**:
- âœ… å›½å®¶ã€å¹´çº§ã€å­¦ç§‘ä¿¡æ¯
- âœ… æ‰¹æ¬¡å¤§å°
- âœ… System Prompt å’Œ User Promptï¼ˆå‰500å­—ç¬¦é¢„è§ˆ + å®Œæ•´å†…å®¹ï¼‰
- âœ… æ¯ä¸ªè¯„ä¼°ç»“æžœçš„è¯¦ç»†ä¿¡æ¯ï¼ˆæ ‡é¢˜ã€URLã€æ‘˜è¦ï¼‰

**è¾“å‡ºé˜¶æ®µ**:
- âœ… LLM å“åº”é•¿åº¦å’Œå†…å®¹ï¼ˆå‰1000å­—ç¬¦é¢„è§ˆ + å®Œæ•´å†…å®¹ï¼‰
- âœ… è§£æžåŽçš„è¯„ä¼°ç»“æžœï¼ˆåˆ†æ•°ã€æŽ¨èç†ç”±ï¼‰

---

### 2. å‰ç«¯ Debug å¼¹çª—å¢žå¼º âœ…

#### æ—¶é—´æ®µé€‰æ‹©åŠŸèƒ½

**æ–°å¢žæŽ§ä»¶**:
- âœ… å¼€å§‹æ—¶é—´é€‰æ‹©å™¨ï¼ˆdatetime-localï¼‰
- âœ… ç»“æŸæ—¶é—´é€‰æ‹©å™¨ï¼ˆdatetime-localï¼‰
- âœ… "æŒ‰æ—¶é—´æ®µå¯¼å‡º" æŒ‰é’®
- âœ… æ—¶é—´æ®µä¿¡æ¯æ˜¾ç¤ºï¼ˆæ˜¾ç¤ºç­›é€‰åŽçš„æ—¥å¿—æ•°é‡ï¼‰

**åŠŸèƒ½**:
- âœ… å®žæ—¶ç­›é€‰ï¼šé€‰æ‹©æ—¶é—´æ®µåŽï¼Œæ—¥å¿—æ˜¾ç¤ºè‡ªåŠ¨æ›´æ–°
- âœ… æ—¶é—´æ®µå¯¼å‡ºï¼šåªå¯¼å‡ºæŒ‡å®šæ—¶é—´æ®µçš„æ—¥å¿—
- âœ… æ–‡ä»¶ååŒ…å«æ—¶é—´æ®µï¼š`debug_log_2025-12-29_21-00-00_to_2025-12-29_22-00-00_exported_2025-12-29_16-30-27.txt`

#### æ—¥å¿—æ•°æ®ç»“æž„å¢žå¼º

**æ–°å¢žå­—æ®µ**:
- âœ… `fullTimestamp`: ISOæ ¼å¼å®Œæ•´æ—¶é—´æˆ³ï¼ˆç”¨äºŽæ—¶é—´æ®µç­›é€‰ï¼‰
- âœ… `datetime`: Dateå¯¹è±¡ï¼ˆç”¨äºŽæ—¶é—´æ¯”è¾ƒï¼‰

**æ—¥å¿—é™åˆ¶**:
- âœ… ä»Ž1000æ¡å¢žåŠ åˆ°5000æ¡ï¼ˆå› ä¸ºæ—¥å¿—æ›´è¯¦ç»†äº†ï¼‰

#### å¯¼å‡ºåŠŸèƒ½å¢žå¼º

**å…¨éƒ¨å¯¼å‡º**:
- âœ… æ–‡ä»¶ååŒ…å«æ—¶é—´æˆ³ï¼š`debug_log_2025-12-29T16-30-27.txt`
- âœ… æ—¥å¿—å†…å®¹åŒ…å«å®Œæ•´æ—¶é—´æˆ³ï¼ˆISOæ ¼å¼ï¼‰

**æ—¶é—´æ®µå¯¼å‡º**:
- âœ… æ–‡ä»¶åæ ¼å¼ï¼š`debug_log_{å¼€å§‹æ—¶é—´}_to_{ç»“æŸæ—¶é—´}_exported_{å¯¼å‡ºæ—¶é—´}.txt`
- âœ… åªå¯¼å‡ºæŒ‡å®šæ—¶é—´æ®µçš„æ—¥å¿—
- âœ… æ˜¾ç¤ºå¯¼å‡ºæ—¥å¿—æ•°é‡

---

## ðŸ“ ä¿®æ”¹çš„æ–‡ä»¶

1. âœ… `search_engine_v2.py`
   - å¢žå¼º `call_llm` æ–¹æ³•çš„æ—¥å¿—è¾“å‡º
   - å¢žå¼º `search` æ–¹æ³•çš„æ—¥å¿—è¾“å‡º

2. âœ… `result_evaluator.py`
   - å¢žå¼º `_evaluate_batch` æ–¹æ³•çš„æ—¥å¿—è¾“å‡º

3. âœ… `templates/index.html`
   - æ·»åŠ æ—¶é—´æ®µé€‰æ‹©æŽ§ä»¶
   - å¢žå¼ºæ—¥å¿—æ•°æ®ç»“æž„ï¼ˆæ·»åŠ å®Œæ•´æ—¶é—´æˆ³ï¼‰
   - ä¿®æ”¹å¯¼å‡ºåŠŸèƒ½ï¼ˆæ”¯æŒæ—¶é—´æ®µå¯¼å‡ºï¼‰
   - å¢žåŠ æ—¥å¿—æ•°é‡é™åˆ¶ï¼ˆ1000 â†’ 5000ï¼‰

---

## ðŸŽ¨ UI æ”¹è¿›

### Debug å¼¹çª—æ–°å¢žåŒºåŸŸ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ðŸ› Debug æ—¥å¿—                    [Ã—]   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [æ¸…ç©ºæ—¥å¿—] [å¯¼å‡ºå…¨éƒ¨æ—¥å¿—] [è‡ªåŠ¨æ»šåŠ¨]   â”‚
â”‚ [â˜‘] åªæ˜¾ç¤ºé”™è¯¯                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ å¼€å§‹æ—¶é—´: [2025-12-29T21:00]           â”‚
â”‚ ç»“æŸæ—¶é—´: [2025-12-29T22:00]           â”‚
â”‚ [æŒ‰æ—¶é—´æ®µå¯¼å‡º]                          â”‚
â”‚ æ˜¾ç¤º 150 æ¡æ—¥å¿—ï¼ˆ21:00 åˆ° 22:00ï¼‰      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [æ—¥å¿—å†…å®¹åŒºåŸŸ]                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ðŸ”§ æŠ€æœ¯å®žçŽ°

### æ—¥å¿—æ•°æ®ç»“æž„

```javascript
{
    timestamp: "17:30:27",           // æ˜¾ç¤ºç”¨æ—¶é—´
    fullTimestamp: "2025-12-29T17:30:27.123Z",  // ISOæ ¼å¼ï¼Œç”¨äºŽç­›é€‰
    datetime: Dateå¯¹è±¡,              // ç”¨äºŽæ—¶é—´æ¯”è¾ƒ
    level: "info|error|warning|debug",
    message: "æ—¥å¿—æ¶ˆæ¯å†…å®¹"
}
```

### æ—¶é—´æ®µç­›é€‰é€»è¾‘

```javascript
const filteredLogs = debugLogs.filter(log => {
    const logDate = new Date(log.fullTimestamp);
    return logDate >= startDate && logDate <= endDate;
});
```

### æ–‡ä»¶åç”Ÿæˆ

```javascript
// å…¨éƒ¨å¯¼å‡º
`debug_log_2025-12-29T16-30-27.txt`

// æ—¶é—´æ®µå¯¼å‡º
`debug_log_2025-12-29_21-00-00_to_2025-12-29_22-00-00_exported_2025-12-29_16-30-27.txt`
```

---

## ðŸ“‹ æ—¥å¿—è¾“å‡ºç¤ºä¾‹

### LLM è°ƒç”¨æ—¥å¿—

```
================================================================================
[ðŸ¤– LLMè°ƒç”¨] å¼€å§‹è°ƒç”¨ deepseek
================================================================================
[ðŸ“¤ è¾“å…¥] Endpoint: https://space.ai-builders.com/backend/v1/chat/completions
[ðŸ“¤ è¾“å…¥] Model: deepseek
[ðŸ“¤ è¾“å…¥] Max Tokens: 2000
[ðŸ“¤ è¾“å…¥] Temperature: 0.3
[ðŸ“¤ è¾“å…¥] System Prompt é•¿åº¦: 500 å­—ç¬¦
[ðŸ“¤ è¾“å…¥] System Prompt (å‰500å­—ç¬¦):
ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„æœç´¢è¯ç”Ÿæˆä¸“å®¶...
[ðŸ“¤ è¾“å…¥] User Prompt é•¿åº¦: 200 å­—ç¬¦
[ðŸ“¤ è¾“å…¥] User Prompt (å‰500å­—ç¬¦):
è¯·ä¸ºä»¥ä¸‹æ•™è‚²è§†é¢‘æœç´¢ç”Ÿæˆæœç´¢è¯...
[ðŸ“¤ è¾“å…¥] å®Œæ•´ User Prompt:
è¯·ä¸ºä»¥ä¸‹æ•™è‚²è§†é¢‘æœç´¢ç”Ÿæˆæœç´¢è¯ï¼š
å›½å®¶ï¼šID
å¹´çº§ï¼šKelas 2
...
[ðŸ“¤ è¾“å…¥] Payload: {
  "model": "deepseek",
  "messages": [...],
  ...
}

[ðŸ“¥ å“åº”] HTTP çŠ¶æ€ç : 200
[ðŸ“¥ å“åº”] å“åº”æ—¶é—´: 2.35 ç§’
[ðŸ“¥ å“åº”] å“åº”ç±»åž‹: dict
[ðŸ“¥ å“åº”] å“åº”é”®: ['id', 'object', 'created', 'model', 'choices', 'usage']
[ðŸ“¥ å“åº”] å®Œæ•´ API å“åº”:
{
  "id": "...",
  "choices": [...],
  "usage": {
    "prompt_tokens": 500,
    "completion_tokens": 100,
    "total_tokens": 600
  }
}
[ðŸ“¥ å“åº”] Finish Reason: stop
[ðŸ“¥ å“åº”] Content é•¿åº¦: 50 å­—ç¬¦
[ðŸ“¥ å“åº”] Token ä½¿ç”¨:
    - Prompt Tokens: 500
    - Completion Tokens: 100
    - Total Tokens: 600
[ðŸ“¥ å“åº”] Content (å‰1000å­—ç¬¦):
playlist pembelajaran bahasa Indonesia kelas 2 SD kurikulum merdeka
[ðŸ“¥ å“åº”] å®Œæ•´ Content:
playlist pembelajaran bahasa Indonesia kelas 2 SD kurikulum merdeka
================================================================================
```

### Tavily æœç´¢æ—¥å¿—

```
================================================================================
[ðŸ” Tavilyæœç´¢] å¼€å§‹æœç´¢
================================================================================
[ðŸ“¤ è¾“å…¥] åŽŸå§‹æŸ¥è¯¢: "Matematika Kelas 3"
[ðŸ“¤ è¾“å…¥] Max Results: 15
[ðŸ“¤ è¾“å…¥] Include Domains: ['ruangguru.com', 'zenius.net']
[ðŸ“¤ è¾“å…¥] Endpoint: https://space.ai-builders.com/backend/v1/search/
[ðŸ”§ å¢žå¼º] æŸ¥è¯¢ä¸­ç¼ºå°‘site:è¯­æ³•ï¼Œæ·»åŠ åŸŸåé™åˆ¶: ['ruangguru.com', 'zenius.net']
[ðŸ“¤ è¾“å…¥] å¢žå¼ºæŸ¥è¯¢: "Matematika Kelas 3 (site:ruangguru.com OR site:zenius.net)"
[ðŸ“¤ è¯·æ±‚] Payload:
{
  "keywords": ["Matematika Kelas 3 (site:ruangguru.com OR site:zenius.net)"],
  "max_results": 15
}

[ðŸ“¥ å“åº”] HTTP çŠ¶æ€ç : 200
[ðŸ“¥ å“åº”] å“åº”æ—¶é—´: 1.25 ç§’
[ðŸ“¥ å“åº”] å“åº”ç±»åž‹: dict
[ðŸ“¥ å“åº”] å®Œæ•´ API å“åº”:
{
  "queries": [
    {
      "response": {
        "results": [...]
      }
    }
  ]
}
[ðŸ“¥ å“åº”] queries æ•°é‡: 1
[ðŸ“¥ å“åº”] Tavily ç»“æžœæ•°é‡: 15
[ðŸ“‹ ç»“æžœ1] Matematika Kelas 3 SD - Ruangguru
    URL: https://ruangguru.com/...
    Snippet é•¿åº¦: 200 å­—ç¬¦
    Snippet (å‰200å­—ç¬¦): Materi pembelajaran matematika untuk kelas 3...
    âœ… åŒ¹é…ç›®æ ‡åŸŸå: ruangguru.com
================================================================================
```

---

## âœ… éªŒè¯æ¸…å•

### åŽç«¯æ—¥å¿—
- [x] LLM è°ƒç”¨è¾“å…¥è¾“å‡ºå®Œæ•´è®°å½•
- [x] Tavily API è°ƒç”¨è¾“å…¥è¾“å‡ºå®Œæ•´è®°å½•
- [x] ç»“æžœè¯„ä¼°è¾“å…¥è¾“å‡ºå®Œæ•´è®°å½•
- [x] é”™è¯¯ä¿¡æ¯è¯¦ç»†è®°å½•ï¼ˆåŒ…å«å †æ ˆè·Ÿè¸ªï¼‰

### å‰ç«¯åŠŸèƒ½
- [x] æ—¶é—´æ®µé€‰æ‹©å™¨æ­£å¸¸å·¥ä½œ
- [x] å®žæ—¶ç­›é€‰åŠŸèƒ½æ­£å¸¸
- [x] å…¨éƒ¨å¯¼å‡ºåŠŸèƒ½æ­£å¸¸ï¼ˆæ–‡ä»¶ååŒ…å«æ—¶é—´æˆ³ï¼‰
- [x] æ—¶é—´æ®µå¯¼å‡ºåŠŸèƒ½æ­£å¸¸ï¼ˆæ–‡ä»¶ååŒ…å«æ—¶é—´æ®µï¼‰
- [x] æ—¥å¿—æ˜¾ç¤ºæ­£ç¡®ï¼ˆåŒ…å«å®Œæ•´æ—¶é—´æˆ³ï¼‰

---

## ðŸ“š ä½¿ç”¨è¯´æ˜Ž

### æŸ¥çœ‹è¯¦ç»†æ—¥å¿—

1. æ‰“å¼€ Debug å¼¹çª—ï¼ˆç‚¹å‡» "ðŸ› Debugæ—¥å¿—" æŒ‰é’®ï¼‰
2. æ‰§è¡Œæœç´¢æ“ä½œ
3. æŸ¥çœ‹æ—¥å¿—ä¸­çš„è¯¦ç»†ä¿¡æ¯ï¼š
   - LLM è°ƒç”¨çš„å®Œæ•´è¾“å…¥è¾“å‡º
   - API è°ƒç”¨çš„å®Œæ•´è¯·æ±‚å“åº”
   - Token ä½¿ç”¨æƒ…å†µ
   - å“åº”æ—¶é—´

### æŒ‰æ—¶é—´æ®µå¯¼å‡ºæ—¥å¿—

1. æ‰“å¼€ Debug å¼¹çª—
2. é€‰æ‹©å¼€å§‹æ—¶é—´å’Œç»“æŸæ—¶é—´ï¼ˆä¾‹å¦‚ï¼š21:00 åˆ° 22:00ï¼‰
3. ç‚¹å‡» "æŒ‰æ—¶é—´æ®µå¯¼å‡º" æŒ‰é’®
4. æ–‡ä»¶ä¼šè‡ªåŠ¨ä¸‹è½½ï¼Œæ–‡ä»¶ååŒ…å«æ—¶é—´æ®µä¿¡æ¯

### å®žæ—¶ç­›é€‰æ—¥å¿—

1. åœ¨æ—¶é—´æ®µé€‰æ‹©å™¨ä¸­é€‰æ‹©å¼€å§‹å’Œç»“æŸæ—¶é—´
2. æ—¥å¿—æ˜¾ç¤ºä¼šè‡ªåŠ¨æ›´æ–°ï¼Œåªæ˜¾ç¤ºè¯¥æ—¶é—´æ®µçš„æ—¥å¿—
3. ä¿¡æ¯æ ä¼šæ˜¾ç¤ºç­›é€‰åŽçš„æ—¥å¿—æ•°é‡

---

**æ›´æ–°å®Œæˆæ—¥æœŸ**: 2025-12-29  
**æ›´æ–°äººå‘˜**: AI Assistant  
**çŠ¶æ€**: âœ… å·²å®Œæˆ

